{"ast":null,"code":"import settingsService from './SettingsService';\nconst MAX_STORED_NOTIFICATIONS = 100;\nclass NotificationService {\n  constructor() {\n    this.hasPermission = false;\n  }\n  async initialize() {\n    if (!('Notification' in window)) {\n      console.log('This browser does not support notifications');\n      return;\n    }\n    if (Notification.permission === 'granted') {\n      this.hasPermission = true;\n    } else if (Notification.permission !== 'denied') {\n      const permission = await Notification.requestPermission();\n      this.hasPermission = permission === 'granted';\n    }\n  }\n  storeNotification(notification) {\n    const stored = this.getStoredNotifications();\n    stored.unshift(notification);\n    if (stored.length > MAX_STORED_NOTIFICATIONS) {\n      stored.length = MAX_STORED_NOTIFICATIONS;\n    }\n    localStorage.setItem('notifications', JSON.stringify(stored));\n  }\n  getStoredNotifications() {\n    const stored = localStorage.getItem('notifications');\n    return stored ? JSON.parse(stored) : [];\n  }\n  notifyNewSignal(signal) {\n    const settings = settingsService.getSettings();\n    if (!settingsService.shouldNotify(signal.priority)) return;\n    const notification = {\n      id: signal.id,\n      title: `New ${signal.type} Signal Detected`,\n      message: `Protocol: ${signal.protocol}\\nPattern: ${signal.pattern.name}\\nConfidence: ${(signal.pattern.confidence * 100).toFixed(1)}%`,\n      timestamp: new Date().toISOString(),\n      priority: signal.priority,\n      signal\n    };\n    this.storeNotification(notification);\n    if (this.hasPermission && settings.notifications.desktopNotifications) {\n      const browserNotification = new Notification(notification.title, {\n        body: notification.message,\n        icon: '/logo192.png',\n        tag: notification.id,\n        requireInteraction: signal.priority >= 8\n      });\n      browserNotification.onclick = () => {\n        window.focus();\n        browserNotification.close();\n      };\n      if (signal.priority < 8) {\n        setTimeout(() => browserNotification.close(), 5000);\n      }\n    }\n  }\n  notifyConnectionStatus(isConnected) {\n    const settings = settingsService.getSettings();\n    if (!isConnected) {\n      const notification = {\n        id: `connection-${Date.now()}`,\n        title: 'Connection Lost',\n        message: 'Lost connection to DeFi Pioneer Watch. Attempting to reconnect...',\n        timestamp: new Date().toISOString(),\n        priority: 10\n      };\n      this.storeNotification(notification);\n    } else {\n      const notification = {\n        id: `connection-${Date.now()}`,\n        title: 'Connection Restored',\n        message: 'Successfully reconnected to DeFi Pioneer Watch.',\n        timestamp: new Date().toISOString(),\n        priority: 9\n      };\n      this.storeNotification(notification);\n    }\n  }\n  clearAllNotifications() {\n    localStorage.setItem('notifications', '[]');\n    localStorage.removeItem('lastNotificationRead');\n  }\n  cleanup() {\n    // This will be initialized from the audioManager\n  }\n}\nconst notificationService = new NotificationService();\nexport default notificationService;","map":{"version":3,"names":["settingsService","MAX_STORED_NOTIFICATIONS","NotificationService","constructor","hasPermission","initialize","window","console","log","Notification","permission","requestPermission","storeNotification","notification","stored","getStoredNotifications","unshift","length","localStorage","setItem","JSON","stringify","getItem","parse","notifyNewSignal","signal","settings","getSettings","shouldNotify","priority","id","title","type","message","protocol","pattern","name","confidence","toFixed","timestamp","Date","toISOString","notifications","desktopNotifications","browserNotification","body","icon","tag","requireInteraction","onclick","focus","close","setTimeout","notifyConnectionStatus","isConnected","now","clearAllNotifications","removeItem","cleanup","notificationService"],"sources":["/Users/toyguntez/Visual Studio /Whale-Watch-Predictive-on-chain-signals/frontend/src/services/NotificationService.ts"],"sourcesContent":["import { Signal } from '../types';\nimport settingsService from './SettingsService';\nimport { audioManager } from '../utils/audioUtils';\nimport { notificationQueue } from '../utils/NotificationQueue';\n\ninterface StoredNotification {\n  id: string;\n  title: string;\n  message: string;\n  timestamp: string;\n  priority: number;\n  signal?: Signal;\n}\n\nconst MAX_STORED_NOTIFICATIONS = 100;\n\nclass NotificationService {\n  private hasPermission: boolean = false;\n\n  async initialize() {\n    if (!('Notification' in window)) {\n      console.log('This browser does not support notifications');\n      return;\n    }\n\n    if (Notification.permission === 'granted') {\n      this.hasPermission = true;\n    } else if (Notification.permission !== 'denied') {\n      const permission = await Notification.requestPermission();\n      this.hasPermission = permission === 'granted';\n    }\n  }\n\n  private storeNotification(notification: StoredNotification) {\n    const stored = this.getStoredNotifications();\n    stored.unshift(notification);\n    \n    if (stored.length > MAX_STORED_NOTIFICATIONS) {\n      stored.length = MAX_STORED_NOTIFICATIONS;\n    }\n\n    localStorage.setItem('notifications', JSON.stringify(stored));\n  }\n\n  private getStoredNotifications(): StoredNotification[] {\n    const stored = localStorage.getItem('notifications');\n    return stored ? JSON.parse(stored) : [];\n  }\n\n  notifyNewSignal(signal: Signal) {\n    const settings = settingsService.getSettings();\n    if (!settingsService.shouldNotify(signal.priority)) return;\n\n    const notification: StoredNotification = {\n      id: signal.id,\n      title: `New ${signal.type} Signal Detected`,\n      message: `Protocol: ${signal.protocol}\\nPattern: ${signal.pattern.name}\\nConfidence: ${(signal.pattern.confidence * 100).toFixed(1)}%`,\n      timestamp: new Date().toISOString(),\n      priority: signal.priority,\n      signal,\n    };\n\n    this.storeNotification(notification);\n\n    if (this.hasPermission && settings.notifications.desktopNotifications) {\n      const browserNotification = new Notification(notification.title, {\n        body: notification.message,\n        icon: '/logo192.png',\n        tag: notification.id,\n        requireInteraction: signal.priority >= 8,\n      });\n\n      browserNotification.onclick = () => {\n        window.focus();\n        browserNotification.close();\n      };\n\n      if (signal.priority < 8) {\n        setTimeout(() => browserNotification.close(), 5000);\n      }\n    }\n  }\n\n  notifyConnectionStatus(isConnected: boolean) {\n    const settings = settingsService.getSettings();\n    \n    if (!isConnected) {\n      const notification: StoredNotification = {\n        id: `connection-${Date.now()}`,\n        title: 'Connection Lost',\n        message: 'Lost connection to DeFi Pioneer Watch. Attempting to reconnect...',\n        timestamp: new Date().toISOString(),\n        priority: 10,\n      };\n\n      this.storeNotification(notification);\n    } else {\n      const notification: StoredNotification = {\n        id: `connection-${Date.now()}`,\n        title: 'Connection Restored',\n        message: 'Successfully reconnected to DeFi Pioneer Watch.',\n        timestamp: new Date().toISOString(),\n        priority: 9,\n      };\n\n      this.storeNotification(notification);\n    }\n  }\n\n  clearAllNotifications() {\n    localStorage.setItem('notifications', '[]');\n    localStorage.removeItem('lastNotificationRead');\n  }\n\n  cleanup() {\n    // This will be initialized from the audioManager\n  }\n}\n\nconst notificationService = new NotificationService();\nexport default notificationService;"],"mappings":"AACA,OAAOA,eAAe,MAAM,mBAAmB;AAa/C,MAAMC,wBAAwB,GAAG,GAAG;AAEpC,MAAMC,mBAAmB,CAAC;EAAAC,YAAA;IAAA,KAChBC,aAAa,GAAY,KAAK;EAAA;EAEtC,MAAMC,UAAUA,CAAA,EAAG;IACjB,IAAI,EAAE,cAAc,IAAIC,MAAM,CAAC,EAAE;MAC/BC,OAAO,CAACC,GAAG,CAAC,6CAA6C,CAAC;MAC1D;IACF;IAEA,IAAIC,YAAY,CAACC,UAAU,KAAK,SAAS,EAAE;MACzC,IAAI,CAACN,aAAa,GAAG,IAAI;IAC3B,CAAC,MAAM,IAAIK,YAAY,CAACC,UAAU,KAAK,QAAQ,EAAE;MAC/C,MAAMA,UAAU,GAAG,MAAMD,YAAY,CAACE,iBAAiB,CAAC,CAAC;MACzD,IAAI,CAACP,aAAa,GAAGM,UAAU,KAAK,SAAS;IAC/C;EACF;EAEQE,iBAAiBA,CAACC,YAAgC,EAAE;IAC1D,MAAMC,MAAM,GAAG,IAAI,CAACC,sBAAsB,CAAC,CAAC;IAC5CD,MAAM,CAACE,OAAO,CAACH,YAAY,CAAC;IAE5B,IAAIC,MAAM,CAACG,MAAM,GAAGhB,wBAAwB,EAAE;MAC5Ca,MAAM,CAACG,MAAM,GAAGhB,wBAAwB;IAC1C;IAEAiB,YAAY,CAACC,OAAO,CAAC,eAAe,EAAEC,IAAI,CAACC,SAAS,CAACP,MAAM,CAAC,CAAC;EAC/D;EAEQC,sBAAsBA,CAAA,EAAyB;IACrD,MAAMD,MAAM,GAAGI,YAAY,CAACI,OAAO,CAAC,eAAe,CAAC;IACpD,OAAOR,MAAM,GAAGM,IAAI,CAACG,KAAK,CAACT,MAAM,CAAC,GAAG,EAAE;EACzC;EAEAU,eAAeA,CAACC,MAAc,EAAE;IAC9B,MAAMC,QAAQ,GAAG1B,eAAe,CAAC2B,WAAW,CAAC,CAAC;IAC9C,IAAI,CAAC3B,eAAe,CAAC4B,YAAY,CAACH,MAAM,CAACI,QAAQ,CAAC,EAAE;IAEpD,MAAMhB,YAAgC,GAAG;MACvCiB,EAAE,EAAEL,MAAM,CAACK,EAAE;MACbC,KAAK,EAAE,OAAON,MAAM,CAACO,IAAI,kBAAkB;MAC3CC,OAAO,EAAE,aAAaR,MAAM,CAACS,QAAQ,cAAcT,MAAM,CAACU,OAAO,CAACC,IAAI,iBAAiB,CAACX,MAAM,CAACU,OAAO,CAACE,UAAU,GAAG,GAAG,EAAEC,OAAO,CAAC,CAAC,CAAC,GAAG;MACtIC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MACnCZ,QAAQ,EAAEJ,MAAM,CAACI,QAAQ;MACzBJ;IACF,CAAC;IAED,IAAI,CAACb,iBAAiB,CAACC,YAAY,CAAC;IAEpC,IAAI,IAAI,CAACT,aAAa,IAAIsB,QAAQ,CAACgB,aAAa,CAACC,oBAAoB,EAAE;MACrE,MAAMC,mBAAmB,GAAG,IAAInC,YAAY,CAACI,YAAY,CAACkB,KAAK,EAAE;QAC/Dc,IAAI,EAAEhC,YAAY,CAACoB,OAAO;QAC1Ba,IAAI,EAAE,cAAc;QACpBC,GAAG,EAAElC,YAAY,CAACiB,EAAE;QACpBkB,kBAAkB,EAAEvB,MAAM,CAACI,QAAQ,IAAI;MACzC,CAAC,CAAC;MAEFe,mBAAmB,CAACK,OAAO,GAAG,MAAM;QAClC3C,MAAM,CAAC4C,KAAK,CAAC,CAAC;QACdN,mBAAmB,CAACO,KAAK,CAAC,CAAC;MAC7B,CAAC;MAED,IAAI1B,MAAM,CAACI,QAAQ,GAAG,CAAC,EAAE;QACvBuB,UAAU,CAAC,MAAMR,mBAAmB,CAACO,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC;MACrD;IACF;EACF;EAEAE,sBAAsBA,CAACC,WAAoB,EAAE;IAC3C,MAAM5B,QAAQ,GAAG1B,eAAe,CAAC2B,WAAW,CAAC,CAAC;IAE9C,IAAI,CAAC2B,WAAW,EAAE;MAChB,MAAMzC,YAAgC,GAAG;QACvCiB,EAAE,EAAE,cAAcU,IAAI,CAACe,GAAG,CAAC,CAAC,EAAE;QAC9BxB,KAAK,EAAE,iBAAiB;QACxBE,OAAO,EAAE,mEAAmE;QAC5EM,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;QACnCZ,QAAQ,EAAE;MACZ,CAAC;MAED,IAAI,CAACjB,iBAAiB,CAACC,YAAY,CAAC;IACtC,CAAC,MAAM;MACL,MAAMA,YAAgC,GAAG;QACvCiB,EAAE,EAAE,cAAcU,IAAI,CAACe,GAAG,CAAC,CAAC,EAAE;QAC9BxB,KAAK,EAAE,qBAAqB;QAC5BE,OAAO,EAAE,iDAAiD;QAC1DM,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;QACnCZ,QAAQ,EAAE;MACZ,CAAC;MAED,IAAI,CAACjB,iBAAiB,CAACC,YAAY,CAAC;IACtC;EACF;EAEA2C,qBAAqBA,CAAA,EAAG;IACtBtC,YAAY,CAACC,OAAO,CAAC,eAAe,EAAE,IAAI,CAAC;IAC3CD,YAAY,CAACuC,UAAU,CAAC,sBAAsB,CAAC;EACjD;EAEAC,OAAOA,CAAA,EAAG;IACR;EAAA;AAEJ;AAEA,MAAMC,mBAAmB,GAAG,IAAIzD,mBAAmB,CAAC,CAAC;AACrD,eAAeyD,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}